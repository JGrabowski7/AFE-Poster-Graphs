facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
View(smallAndMOG)
View(smallAndMOG)
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Condition %in% c(1,3,6,7))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_Condition %in% c(1,3,6,7))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_condition %in% c(1,3,6,7))
View(small_trees)
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(1,3,6,7)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_condition %in% c(1,3,7))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>% #& Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>% #& Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
tree_data <- read.csv("data/all_trees_2024.csv")
tree_data$Plot <- str_extract(tree_data$TreeID, "[^-]+")
tree_data <- tree_data %>%
mutate(TreatmentStatus = (case_when(Plot == "SFS4" ~ "Treated",
Plot == "BTN4" ~ "Untreated",
Plot == "SFF1" ~ "Treated",
Plot == "SFF2" ~ "Untreated",
Plot == "SFF3" ~ "Untreated",
Plot == "SFF4" ~ "Untreated",
Plot == "SFF5" ~ "Treated",
Plot == "SFF6" ~ "Untreated",
Plot == "SFF7" ~ "Treated",
Plot == "SFF8" ~ "Treated",
Plot == "SFF9" ~ "Untreated",
Plot == "SFF10" ~ "Treated",
)))
tree_data <- tree_data %>%
mutate(PlotSize = (case_when(Plot == "SFS4" ~ 1,
Plot == "BTN4" ~ 1,
Plot == "SFF1" ~ 0.25,
Plot == "SFF2" ~ 1,
Plot == "SFF3" ~ 0.25,
Plot == "SFF4" ~ 0.25,
Plot == "SFF5" ~ 0.25,
Plot == "SFF6" ~ 0.25,
Plot == "SFF7" ~ 0.25,
Plot == "SFF8" ~ 1,
Plot == "SFF9" ~ 0.25,
Plot == "SFF10" ~ 0.25,
)))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
View(small_trees)
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>% #& Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
View(MOG_trees)
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
tree_data <- read.csv("data/all_trees_2024.csv")
tree_data$Plot <- str_extract(tree_data$TreeID, "[^-]+")
tree_data <- tree_data %>%
mutate(TreatmentStatus = (case_when(Plot == "SFS4" ~ "Treated",
Plot == "BTN4" ~ "Untreated",
Plot == "SFF1" ~ "Treated",
Plot == "SFF2" ~ "Untreated",
Plot == "SFF3" ~ "Untreated",
Plot == "SFF4" ~ "Untreated",
Plot == "SFF5" ~ "Treated",
Plot == "SFF6" ~ "Untreated",
Plot == "SFF7" ~ "Treated",
Plot == "SFF8" ~ "Treated",
Plot == "SFF9" ~ "Untreated",
Plot == "SFF10" ~ "Treated",
)))
tree_data <- tree_data %>%
mutate(PlotSize = (case_when(Plot == "SFS4" ~ 1,
Plot == "BTN4" ~ 1,
Plot == "SFF1" ~ 0.25,
Plot == "SFF2" ~ 1,
Plot == "SFF3" ~ 0.25,
Plot == "SFF4" ~ 0.25,
Plot == "SFF5" ~ 0.25,
Plot == "SFF6" ~ 0.25,
Plot == "SFF7" ~ 0.25,
Plot == "SFF8" ~ 1,
Plot == "SFF9" ~ 0.25,
Plot == "SFF10" ~ 0.25,
)))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>% #& Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
View(smallAndMOG)
View(smallAndMOG)
tree_data <- read.csv("data/all_trees_2024.csv")
tree_data$Plot <- str_extract(tree_data$TreeID, "[^-]+")
tree_data <- tree_data %>%
mutate(TreatmentStatus = (case_when(Plot == "SFS4" ~ "Treated",
Plot == "BTN4" ~ "Untreated",
Plot == "SFF1" ~ "Treated",
Plot == "SFF2" ~ "Untreated",
Plot == "SFF3" ~ "Untreated",
Plot == "SFF4" ~ "Untreated",
Plot == "SFF5" ~ "Treated",
Plot == "SFF6" ~ "Untreated",
Plot == "SFF7" ~ "Treated",
Plot == "SFF8" ~ "Treated",
Plot == "SFF9" ~ "Untreated",
Plot == "SFF10" ~ "Treated",
)))
tree_data <- tree_data %>%
mutate(PlotSize = (case_when(Plot == "SFS4" ~ 1,
Plot == "BTN4" ~ 1,
Plot == "SFF1" ~ 0.25,
Plot == "SFF2" ~ 1,
Plot == "SFF3" ~ 0.25,
Plot == "SFF4" ~ 0.25,
Plot == "SFF5" ~ 0.25,
Plot == "SFF6" ~ 0.25,
Plot == "SFF7" ~ 0.25,
Plot == "SFF8" ~ 1,
Plot == "SFF9" ~ 0.25,
Plot == "SFF10" ~ 0.25,
)))
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO"))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) %>% #& Tree_condition %in% c(2, 5, 6, 8, 9)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
View(small_trees)
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
View(smallAndMOG)
View(smallAndMOG)
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID", "Size"))
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID", "PlotSize"))
View(smallAndMOG)
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
View(smallAndMOG)
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
View(smallAndMOG)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_condition %in% c(1, 3, 7))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) & Tree_condition %in% c(1, 3, 7)) %>%
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) & Tree_condition %in% c(1, 3, 7) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
View(tree_data)
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_condition %in% c(1, 3, 7))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME")) & Tree_condition %in% c(1, 3, 7) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
small_trees <- filter(tree_data, Diameter < 2.5 & SpeciesID %in% c("PIPO", "PIST", "PSME", "ABCO") & Tree_condition %in% c(1,3,7))
small_trees <- small_trees %>%
group_by(Plot, PlotSize, SpeciesID) %>%
summarize(small_tree_count=n())
small_trees$small_tree_density <- small_trees$small_tree_count / small_trees$PlotSize
tree_data <- tree_data %>%
mutate(MOG = case_when(Old_growth == "Y" | Diameter > 30 ~ "Y"))
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(1,3,7)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
mod = lm(small_tree_density ~ MOG_density, data = smallAndMOG)
summary(mod)
mod = lm(small_tree_density ~ MOG_density + SpeciesID, data = smallAndMOG)
summary(mod)
install.package("glmmTMB")
install.packages("glmmTMB")
library(glmmTMB)
glm = glmmTMB(small_tree_density ~ MOG_density + (1|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(small_tree_density ~ poly(MOG_density, 2) + (1|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(small_tree_density ~ poly(MOG_density, 3) + (1|SpeciesID), data = smallAndMOG)
summary(glm)
hist(smallAndMOG$small_tree_density)
hist(smallAndMOG$MOG_density)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density + (1|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(sqrt(small_tree_density) ~ MOG_density + (1|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(sqrt(small_tree_density) ~ MOG_density + (MOG_density|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(small_tree_density ~ MOG_density + (1|SpeciesID), data = smallAndMOG, family = "nbinom2")
summary(glm)
glm = glmmTMB(small_tree_density ~ MOG_density + (1|SpeciesID), data = smallAndMOG, family = "poisson")
summary(glm)
View(smallAndMOG)
glm = glmmTMB(small_tree_density ~ MOG_density + (1|SpeciesID), data = smallAndMOG, family = "poisson", ziformula = ~.)
summary(glm)
glm = glmmTMB(small_tree_density ~ MOG_density + (1|SpeciesID), data = smallAndMOG, family = "nbinom2", ziformula = ~.)
summary(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density + (1|SpeciesID), data = smallAndMOG)
summary(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density, data = smallAndMOG)
summary(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density*SpeciesID, data = smallAndMOG)
summary(glm)
performance::r2(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density*SpeciesID, data = subset(smallAndMOG, SpeciesID == "PIST"))
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIST"))
summary(glm)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIST"))
summary(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIPO"))
summary(glm)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density, pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density), method = "lm")
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y= log(small_tree_density +1), pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=log(small_tree_density + 1)), method = "lm")
performance::r2(glm)
glm = glmmTMB(log(small_tree_density + 1) ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIST"))
summary(glm)
performance::r2(glm)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIST"))
summary(glm)
performance::r2(glm)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIPO"))
summary(glm)
performance::r2(glm)
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(1, 2, 3, 5, 7)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees <- tree_data %>%
filter(MOG == "Y" &  SpeciesID %in% c("PIPO", "ABCO", "PIST", "PSME") & Tree_condition %in% c(1, 2, 3, 5, 7)) %>%
group_by(Plot, PlotSize, SpeciesID, TreatmentStatus) %>%
summarize(MOG_count = n())
MOG_trees$MOG_density <- MOG_trees$MOG_count / MOG_trees$PlotSize
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y= log(small_tree_density +1), pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=log(small_tree_density + 1)), method = "lm")
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density , pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density ), method = "lm")
mod = lm(small_tree_density ~ MOG_density + SpeciesID, data = smallAndMOG)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIPO"))
summary(glm)
performance::r2(glm)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PIST"))
summary(glm)
performance::r2(glm)
glm = glmmTMB(small_tree_density ~ MOG_density, data = subset(smallAndMOG, SpeciesID == "PSME"))
summary(glm)
performance::r2(glm)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density , pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density ), method = "lm")
smallAndMOG <- full_join(MOG_trees, small_trees, by = c("Plot", "SpeciesID", "PlotSize"))
smallAndMOG$MOG_density <- ifelse(is.na(smallAndMOG$MOG_density), 0, smallAndMOG$MOG_density)
smallAndMOG$small_tree_density <- ifelse(is.na(smallAndMOG$small_tree_density), 0, smallAndMOG$small_tree_density)
smallAndMOG$TreatmentStatus <- ifelse(is.na(smallAndMOG$TreatmentStatus), "Untreated", smallAndMOG$TreatmentStatus)
ggplot() +
geom_point(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density , pch = TreatmentStatus)) +
facet_wrap(~ SpeciesID, scales = "free") +
geom_smooth(smallAndMOG, mapping=aes(x=MOG_density,y=small_tree_density ), method = "lm")
ggplot(dbh_2.5_cond, aes(x=DBH, fill = Condition)) +
geom_histogram(stat = "count", position = "dodge") +
facet_wrap(~ Species) +
scale_color_manual(labels = c("live", "dead", "dalb"))
ggplot(dbh_2.5_cond, aes(x=DBH, fill = Condition)) +
geom_histogram(stat = "count", position = "dodge") +
facet_wrap(~ Species) +
scale_color_manual(labels = c("live", "dead", "dalb"))
ggplot(dbh_2.5_cond, aes(x=DBH, fill = Condition)) +
geom_histogram(stat = "count", position = "dodge") +
facet_wrap(~ Species) +
scale_color_manual(labels = c("live", "dead", "dalb"))
veg_data <- read.csv("data/veg features.csv")
veg_data$Plot<-str_extract(veg_data$PlotID, "[^-]+")
veg_data <- veg_data %>%
mutate(TreatmentStatus = (case_when(Plot == "SFS4V" ~ "Treated",
Plot == "BTN4V" ~ "Untreated",
Plot == "SFF1V" ~ "Treated",
Plot == "SFF2V" ~ "Untreated",
Plot == "SFF3V" ~ "Untreated",
Plot == "SFF4V" ~ "Untreated",
Plot == "SFF5V" ~ "Treated",
Plot == "SFF6V" ~ "Untreated",
Plot == "SFF7V" ~ "Treated",
Plot == "SFF8V" ~ "Treated",
Plot == "SFF9V" ~ "Untreated",
Plot == "SFF10V" ~ "Treated",
)))
t_basal_data <- filter(veg_data, TreatmentStatus == "Treated",CoverType == "Basal" & Percent != "T")
t_basal_data$Percent <- as.numeric(t_basal_data$Percent)
u_basal_data <- filter(veg_data, TreatmentStatus == "Untreated", CoverType == "Basal" & Percent != "T")
u_basal_data$Percent <- as.numeric(u_basal_data$Percent)
t_mean_basal_cover<- t_basal_data %>%
group_by(CoverClass)%>%
summarise(PercentSum = sum(Percent))
t_mean_basal_cover <- t_mean_basal_cover %>%
mutate(avg = t_mean_basal_cover$PercentSum / 72,
TreatmentStatus = "Treated")
u_mean_basal_cover <- u_basal_data %>%
group_by(CoverClass)%>%
summarise(PercentSum = sum(Percent))
u_mean_basal_cover <- u_mean_basal_cover %>%
mutate(avg = u_mean_basal_cover$PercentSum / 72,
TreatmentStatus = "Untreated")
list <- list(t_mean_basal_cover, u_mean_basal_cover)
all_basal_cover <- list %>% reduce(full_join, by= c("CoverClass", "PercentSum", "avg", "TreatmentStatus"))
View(all_basal_cover)
View(veg_data)
t_data$Percent %>% group_by(LifeForm, TreatmentStatus, Species, Plot)
veg_data$Percent %>% group_by(LifeForm, TreatmentStatus, Species, Plot)
veg_data$Percent %>% group_by(c(LifeForm, TreatmentStatus, Species, Plot))
veg_data %>% group_by(c(LifeForm, TreatmentStatus, Species, Plot))
veg_data %>% group_by(LifeForm, TreatmentStatus, Species, Plot)
veg_data <- as.data.table(veg_data)
t_data <- veg_data[,.  (sum=sum(Percent)),by=c("LifeForm","TreatmentStatus","Species","Plot")]
veg_data$Percent <- ifelse(veg_data$Percent == "T", 0.1, veg_data$Percent)
t_data <- veg_data[,.  (sum=sum(Percent)),by=c("LifeForm","TreatmentStatus","Species","Plot")]
veg_data$Percent <- as.numeric(ifelse(veg_data$Percent == "T", 0.1, veg_data$Percent))
t_data <- veg_data[,.  (sum=sum(Percent)),by=c("LifeForm","TreatmentStatus","Species","Plot")]
View(t_data)
r_data <- t_data[,. (richness = .N), by = Plot]
View(r_data)
r_data <- t_data[,. (richness = .N), by = c(Plot, TreatmentStatus)]
r_data <- t_data[,. (richness = .N), by = c("Plot", "TreatmentStatus")]
View(r_data)
r_data <- t_data[,. (richness = .N), by = c("Plot", "TreatmentStatus")]
ggplot() +
geom_boxplot(r_data, mapping = aes(x=TreatmentStatus, y = richness))
mod = lm(richness ~ TreatmentStatus, data = r_data)
summary(mod)
View(r_data)
ggplot() +
geom_boxplot(r_data, mapping = aes(x=TreatmentStatus, y = richness)) +
theme_bw()
hist(r_data$richness)
ggplot() +
geom_density(r_data, mapping = aes(x=TreatmentStatus, fill = richness), alpha = 0.5) +
theme_bw()
ggplot() +
geom_density(r_data, mapping = aes(x=richness, fill = TreatmentStatus), alpha = 0.5) +
theme_bw()
wilcox.test(r_data$richness, r_data$TreatmentStatus)
wilcox.test(r_data$TreatmentStatus, r_data$richness)
trt<-r_data[TreatmentStatus=="T"]
View(r_data)
trt<-subset(r_data , TreatmentStatus =="Treated")
View(trt)
untrt<-subset(r_data , TreatmentStatus =="Untreated")
wilcox.test(trt$richness, untrt$richness)
kruskal.test(trt$richness, untrt$richness)
g_data = subset(t_data, LifeForm == "Graminoid")
View(g_data)
ggplot() +
geom_boxplot(g_data, aes = mapping(x = TreatmentStatus, y = Percent))
ggplot() +
geom_boxplot(g_data, mapping = aes(x = TreatmentStatus, y = sum))
mod = lm(sum ~ TreatmentStatus, data = g_data)
summary(mod)
mod2 = glmmTMB(sum ~ TreatmentStatus + (1|LifeForm), data = t_data)
summary(mod2)
